# Exploitation

## Content

* [Allocators](#allocators)
* [Debugging, Tracing and Instrumentation](#debugging-tracing-and-instrumentation)
* [Embedded and RTOS](#embedded-and-rtos)
* [Guides, Tutorials and Writeups](#guides-tutorials-and-writeups)
  * [Heap](#heap)
  * [Linux kernel](#linux-kernel)
* [Libcs](#libcs)
* [Mitigations](#mitigations)
* [Misc](#misc)
* [Practice](#practice)
* [TEE](#tee)
* [Tools](#tools)

## Allocators

## Debugging, Tracing and Instrumentation

## Embedded and RTOS

* "MCUBOOT: Security Assessment":
  * [Part 1][121]
  * [Part 2][122]
* "MCUBoot Under (good) Pressure":
  * [Part 1][123]
  * [Part 2][124]
* ["Zephyr and MCUboot Security Analysis"][120]

## Guides, Tutorials and Writeups

### Heap

* ["Dynamic Allocator Misuse" (pwn.college)][89]
* [Exploiting Heap Allocators][20]: part of CS6265: Information Security Lab
* [Heap Exploitation (dhavalkapil)][2]: guide for understanding the internals of
'heap memory.
* [Heap Exploitation (nightmare)][11]: heap tutorials (part of the Nightmare
binary exploitation series)
* [how2heap][25]: epository for learning various heap exploitation techniques.
* Writeups:
  * ["Behind the Shield: Unmasking Scudo's Defenses"][31]
  * ["Bypassing GLIBC 2.32’s Safe-Linking Without Leaks into Code Execution: The House of Rust"][60]
  * ["Diving deep into heap — Glibc fastbin consolidation"][27]
  * "Diving deep into the heap"
    * [Part 1][38]
    * [Part 2][39]
  * ["Don't Be Silly - It's Only a Lightbulb"][12]
  * ["Everything In It’s Right Place"][77]
  * ["Exploiting an Unbounded memcpy in Parallels Desktop"][127]
  * ["Exploring Android Heap Allocations in jemalloc 'New'"][30]
  * "Glibc Heap Exploitation Basics":
    * [Part 1][86]
    * [Part 2][87]
    * [Part 3][88]
  * Heap Exploitation Series by Azeria
    * ["Part 1: Understanding the Glibc Heap Implementation"][13]
    * ["Part 2: Understanding the Glibc Heap Implementation"][14]
    * ["Case Study from an in-the-wild iOS 0-day"][15]
    * ["Heap Overflows and the iOS Kernel Heap"][16]
    * ["Grooming the iOS Kernel Heap"][17]
  * ["Heap overflow using Malloc Maleficarum"][72]
  * ["Heap overflow using unlink"][71]
  * ["House of Corrosion"][24]
  * ["House of Io – Remastered"][69]
  * ["Off-By-One Vulnerability (Heap Based)"][73]
  * ["Overview of Malloc"][40] (glibc documentation)
  * ["Safe-Linking – Eliminatig a 20 Year-Old malloc() Exploit Primitive"][75]
  * "The art of exploiting heap overflow":
    * [Part 1][96]
    * [Part 2][97]
    * [Part 3][98]
    * [Part 4][99]
    * [Part 5][100]
    * [Part 6][101]
    * [Part 7][102]
  * ["The Malloc Maleficarum"][22]
  * "The toddler’s introduction to Heap Exploitation"
    * [Part 1][78]
    * [Part 2][79]
    * [Part 3][80]
    * [Part 4][81]
    * [Part 4.1][82]
    * [Part 4.2][83]
    * [Part 4.3][84]
    * [Part 4.4][85]
  * ["Understanding glibc malloc"][70]
  * ["Understanding the Heap - a beautiful mess"][95]
  * ["Use-After-Free"][74]
  * ["Vudo malloc tricks"][76]
  * ["x86 Exploitation 101: “House of Lore” – People and Traditions"][26]

### Linux Kernel

* [DirtyCow][50]: race condition in the way the Linux kernel's memory subsystem
handled the copy-on-write.
* [DirtyPipe][51]: pipes and splices for verwriting data in arbitrary read-only
files.
  * ["Technical Review: A Deep Analysis of the Dirty Pipe Vulnerability"][52]
* [Kernel exploitation][1]: collection of resources for kernel layer
exploitation.
* [linux-kernel-exploitation][0]: collection of links related to Linux kernel
security and exploitation.
* Writeups:
  * ["A Systematic Study of Elastic Objects in Kernel Exploitation"][48]
  * "CVE-2017-11176: A step-by-step Linux Kernel exploitation":
    * [Part 1][44]
    * [Part 2][45]
    * [Part 3][46]
    * [Part 4][47]
  * ["Canary in the Kernel Mine: Exploiting and Defending Against Same-Type Object Reuse"][110]
  * ["Cautious! A New Exploitation Method! No Pipe but as Nasty as Dirty Pipe"][107]
  * ["corCTF 2021 Fire of Salvation Writeup: Utilizing msg_msg Objects for Arbitrary Read and Arbitrary Write in the Linux Kernel"][54]
  * ["Devils Are in the File Descriptors: It Is Time To Catch Them All"][108]
  * ["Dirty Pagetable: A Novel Exploitation Technique To Rule Linux Kernel"][103]
  * ["Exploit Engineering – Attacking the Linux Kernel"][125]
  * ["Exploting Kernel Races Through Taming Thread Interleaving"][105]
  * ["Exploiting null-dereferences in the Linux kernel"][119]
  * ["Exploiting race conditions on [ancient] Linux"][104]
  * ["Four Bytes of Power: Exploiting CVE-2021-26708 in the Linux kernel"][55]
  * ["Function Granular KASLR"][42]
  * ["How a simple Linux kernel memory corruption bug can lead to complete system compromise"][112]
  * ["Introduction to kernel exploitation"][32]
  * "Linux Kernel ROP":
    * [Part 1][40]
    * [Part 2][41]
  * "Linux SLUB Allocator Internals and Debugging":
    * [Part 1][56]
    * [Part 2][57]
    * [Part 3][58]
    * [Part 4][59]
  * ["Monitoring Surveillance Vendors: A Deep Dive into In-the-Wild Android Full Chains in 2021"][109]
  * ["ret2dir: Rethinking Kernel Isolation"][49]
  * ["Ret2page: The Art of Exploiting Use-After-Free Vulnerabili4es in the Dedicated Cache"][111]
  * ["USMA: Share Kernel Code with Me"][106]
  * ["Wall Of Perdition: Utilizing msg_msg Objects For Arbitrary Read And Arbitrary Write In The Linux Kernel"][53]

### Other

* [CS6265: Information Security Lab][21]: Reversing, debugging, exploitation
tutorials.
* Writeups:
  * ["BleedingTooth: Linux Bluetooth Zero-Click Remote Code Execution"][28]
  * "Learning Linux kernel exploitation" (0x434b):
    * ["Part 1 - Laying the groundwork"][33]
    * ["Part 2 - CVE-2022-0847"][34]
  * "Learning Linux Kernel Exploitation" (lkmidas):
    * [Part 1][35]
    * [Part 2][36]
    * [Part 3][37]
  * ["nftables Adventures: Bug Hunting and N-day Exploitation (CVE-2023-31248)"][29]
  * "Over the Air":
    * ["Exploiting Broadcom’s Wi-Fi Stack (Part 1)"][113]
    * ["Exploiting Broadcom’s Wi-Fi Stack (Part 2)"][114]
    * ["Exploiting The Wi-Fi Stack on Apple Devices (Pt. 1)"][115]
    * ["Exploiting The Wi-Fi Stack on Apple Devices (Pt. 2)"][116]
    * ["Exploiting The Wi-Fi Stack on Apple Devices (Pt. 3)"][117]

## Libcs

* [Bionic][67]
  * [Documentation][68]
* [glibc][61]
  * [Documentation][63]
* [musl][65]
  * [Documentation][66]
* [uclibc-ng][62]
  * [Documentation][64]

## Mitigations

## Misc

* [KernelCTF][10]: KernelCTf by Google.
* [Linux Kernel Defence Map][23]: relationships between vulnerability classes,
exploitation techniques, bug detection mechanisms, and defence technologies.
* ["The Oddest Place You Will Ever Find PAC"][126]

## Practice

* [awesome-ctf (wargames)][9]: list of wargames websites.
* [exploit.education][5]: VM for practiving exploitation.
* [overthewire][8]: earn and practice security concepts.
* [pwn.college][4]: learn about, and practice, core cybersecurity concepts in a
hands-on fashion.
* [pwnable.kr][3]: wargame site which provides various pwn challenges.
* [pwnable.tw][6]: wargame site for hackers to test and expand their binary
exploiting skills.
* [ropemporium][7]: learn return-oriented programming through a series of
challenges.

## TEE

* ["ARM TrustZone: pivoting to the secure world"][118]
* [TEE-reversing][94]
* Writeups:
  * "Breaking TEE Security":
    * ["part 1"][90]
    * ["part 2"][91]
    * ["part 3"][92]
  * ["Trust Issues: Exploiting TrustZone TEEs"][93]

## Tools

* [GEF][18]: GDB Enhanced Feature
* [pwntools][19]: CTF framework and exploit development library

[0]: https://github.com/xairy/linux-kernel-exploitation
[1]: https://low-level.readthedocs.io/en/latest/security/kernel/
[2]: https://heap-exploitation.dhavalkapil.com
[3]: http://pwnable.kr/#
[4]: https://pwn.college
[5]: https://exploit.education
[6]: https://pwnable.tw
[7]: https://ropemporium.com/index.html
[8]: https://overthewire.org/wargames/
[9]: https://github.com/apsdehal/awesome-ctf#wargames
[10]: https://google.github.io/security-research/kernelctf/rules.html
[11]: https://guyinatuxedo.github.io/25-heap/index.html
[12]: https://research.checkpoint.com/2020/dont-be-silly-its-only-a-lightbulb/
[13]: https://azeria-labs.com/heap-exploitation-part-1-understanding-the-glibc-heap-implementation/
[14]: https://azeria-labs.com/heap-exploitation-part-2-glibc-heap-free-bins/
[15]: https://azeria-labs.com/heap-exploit-development-part-1/
[16]: https://azeria-labs.com/heap-overflows-and-the-ios-kernel-heap/
[17]: https://azeria-labs.com/grooming-the-ios-kernel-heap/
[18]: https://github.com/hugsy/gef
[19]: https://github.com/Gallopsled/pwntools
[20]: https://tc.gts3.org/cs6265/2019/tut/tut09-02-advheap.html
[21]: https://tc.gts3.org/cs6265/2019/tut/tut01-warmup1.html
[22]: https://seclists.org/bugtraq/2005/Oct/118?=ref=0x434b.dev
[23]: https://github.com/a13xp0p0v/linux-kernel-defence-map
[24]: https://github.com/CptGibbon/House-of-Corrosion
[25]: https://github.com/shellphish/how2heap
[26]: https://gbmaster.wordpress.com/2015/07/16/x86-exploitation-101-house-of-lore-people-and-traditions/
[27]: https://medium.com/@soh0ro0t/diving-deep-into-heap-glibc-fastbin-consolidation-4c1f38a70917
[28]: https://google.github.io/security-research/pocs/linux/bleedingtooth/writeup.html
[29]: https://starlabs.sg/blog/2023/09-nftables-adventures-bug-hunting-and-n-day-exploitation/
[30]: https://www.synacktiv.com/en/publications/exploring-android-heap-allocations-in-jemalloc-new
[31]: https://www.synacktiv.com/publications/behind-the-shield-unmasking-scudos-defenses
[32]: https://kernemporium.github.io/kernel/intro/
[33]: https://0x434b.dev/dabbling-with-linux-kernel-exploitation-ctf-challenges-to-learn-the-ropes/
[34]: https://0x434b.dev/learning-linux-kernel-exploitation-part-2-cve-2022-0847/
[35]: https://lkmidas.github.io/posts/20210123-linux-kernel-pwn-part-1/
[36]: https://lkmidas.github.io/posts/20210128-linux-kernel-pwn-part-2/
[37]: https://lkmidas.github.io/posts/20210205-linux-kernel-pwn-part-3/
[38]: https://www.tooboat.com/?p=556
[39]: https://www.tooboat.com/?p=629
[40]: https://sourceware.org/glibc/wiki/MallocInternals
[41]: https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-1/?ref=0x434b.dev
[42]: https://www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/linux-kernel-rop-ropping-your-way-to-part-2/?ref=0x434b.dev
[43]: https://lwn.net/Articles/824307/?ref=0x434b.dev
[44]: https://blog.lexfo.fr/cve-2017-11176-linux-kernel-exploitation-part1.html
[45]: https://blog.lexfo.fr/cve-2017-11176-linux-kernel-exploitation-part2.html
[46]: https://blog.lexfo.fr/cve-2017-11176-linux-kernel-exploitation-part3.html
[47]: https://blog.lexfo.fr/cve-2017-11176-linux-kernel-exploitation-part4.html
[48]: https://zplin.me/papers/ELOISE.pdf?ref=0x434b.dev
[49]: https://cs.brown.edu/~vpk/papers/ret2dir.sec14.pdf?ref=0x434b.dev
[50]: https://github.com/dirtycow/dirtycow.github.io/wiki/VulnerabilityDetails
[51]: https://dirtypipe.cm4all.com/?ref=0x434b.dev
[52]: https://blog.aquasec.com/deep-analysis-of-the-dirty-pipe-vulnerability
[53]: https://syst3mfailure.io/wall-of-perdition/
[54]: https://www.willsroot.io/2021/08/corctf-2021-fire-of-salvation-writeup.html
[55]: https://a13xp0p0v.github.io/2021/02/09/CVE-2021-26708.html
[56]: https://blogs.oracle.com/linux/post/linux-slub-allocator-internals-and-debugging-1
[57]: https://blogs.oracle.com/linux/post/linux-slub-allocator-internals-and-debugging-2
[58]: https://blogs.oracle.com/linux/post/linux-slub-allocator-internals-and-debugging-3
[59]: https://blogs.oracle.com/linux/post/linux-slub-allocator-internals-and-debugging-4
[60]: https://c4ebt.github.io/2021/01/22/House-of-Rust.html
[61]: https://sourceware.org/git/?p=glibc.git
[62]: https://cgit.uclibc-ng.org/cgi/cgit/uclibc-ng.git/
[63]: https://www.gnu.org/software/libc/manual/
[64]: https://uclibc-ng.org/docs/
[65]: https://git.musl-libc.org/cgit/musl
[66]: https://musl.libc.org/manual.html
[67]: https://android.googlesource.com/platform/bionic/
[68]: https://android.googlesource.com/platform/bionic/+/refs/heads/main/docs/
[69]: https://awaraucom.wordpress.com/2020/07/19/house-of-io-remastered/
[70]: https://sploitfun.wordpress.com/2015/02/10/understanding-glibc-malloc/
[71]: https://sploitfun.wordpress.com/2015/02/26/heap-overflow-using-unlink/
[72]: https://sploitfun.wordpress.com/2015/03/04/heap-overflow-using-malloc-maleficarum/
[73]: https://sploitfun.wordpress.com/2015/06/09/off-by-one-vulnerability-heap-based/
[74]: https://sploitfun.wordpress.com/2015/06/16/use-after-free/
[75]: https://research.checkpoint.com/2020/safe-linking-eliminating-a-20-year-old-malloc-exploit-primitive/
[76]: http://phrack.org/issues/57/8.html
[77]: https://medium.com/@kevin.massey1189/everything-in-its-right-place-20aacd17fe3f
[78]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-part-1-515b3621e0e8
[79]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-part-2-d1f325b74286
[80]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-overflows-part-3-d3d1aa042d1e
[81]: https://infosecwriteups.com/use-after-free-13544be5a921
[82]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-fastbin-dup-to-stack-part-4-1-425592a2870b
[83]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-fastbin-dup-consolidate-part-4-2-ce6d68136aa8
[84]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-unsafe-unlink-part-4-3-75e00e1b0c68
[85]: https://infosecwriteups.com/the-toddlers-introduction-to-heap-exploitation-house-of-spirit-part-4-4-252cd8928f84
[86]: https://blog.k3170makan.com/2018/11/glibc-heap-exploitation-basics.html
[87]: https://blog.k3170makan.com/2018/12/glibc-heap-exploitation-basics.html
[88]: https://blog.k3170makan.com/2019/03/glibc-heap-exploitation-basics.html
[89]: https://pwn.college/software-exploitation/dynamic-allocator-misuse
[90]: https://www.riscure.com/tee-security-samsung-teegris-part-1/
[91]: https://www.riscure.com/tee-security-samsung-teegris-part-2/
[92]: https://www.riscure.com/tee-security-samsung-teegris-part-3/
[93]: https://googleprojectzero.blogspot.com/2017/07/trust-issues-exploiting-trustzone-tees.html
[94]: https://github.com/enovella/TEE-reversing
[95]: https://jackfromeast.site/2023-01/understand-the-heap-a-beautiful-mess.html
[96]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-1-3bcf41e0d449
[97]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-2-1bd24a5856d0
[98]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-3-9890b01d56a2
[99]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-4-4f1140585210
[100]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-5-934192cba269
[101]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-6-14410c9ba6a6
[102]: https://medium.com/@c0ngwang/the-art-of-exploiting-heap-overflow-part-7-10a788dd7ab
[103]: https://yanglingxi1993.github.io/dirty_pagetable/dirty_pagetable.html
[104]: https://static.sched.com/hosted_files/lsseu2019/04/LSSEU2019%20-%20Exploiting%20race%20conditions%20on%20Linux.pdf
[105]: https://lifeasageek.github.io/papers/yoochan-exprace-bh.pdf
[106]: https://i.blackhat.com/Asia-22/Thursday-Materials/AS-22-YongLiu-USMA-Share-Kernel-Code.pdf
[107]: https://i.blackhat.com/USA-22/Thursday/US-22-Lin-Cautious-A-New-Exploitation-Method.pdf
[108]: https://i.blackhat.com/USA-22/Wednesday/US-22-Wu-Devils-Are-in-the-File.pdf
[109]: https://i.blackhat.com/USA-22/Wednesday/US-22-Jin-Monitoring-Surveillance-Vendors.pdf
[110]: https://grsecurity.net/exploiting_and_defending_against_same_type_object_reuse
[111]: https://i.blackhat.com/USA-22/Thursday/US-22-WANG-Ret2page-The-Art-of-Exploiting-Use-After-Free-Vulnerabilities-in-the-Dedicated-Cache.pdf
[112]: https://googleprojectzero.blogspot.com/2021/10/how-simple-linux-kernel-memory.html
[113]: https://googleprojectzero.blogspot.com/2017/04/over-air-exploiting-broadcoms-wi-fi_4.html
[114]: https://googleprojectzero.blogspot.com/2017/04/over-air-exploiting-broadcoms-wi-fi_11.html
[115]: https://googleprojectzero.blogspot.com/2017/09/over-air-vol-2-pt-1-exploiting-wi-fi.html
[116]: https://googleprojectzero.blogspot.com/2017/10/over-air-vol-2-pt-2-exploiting-wi-fi.html
[117]: https://googleprojectzero.blogspot.com/2017/10/over-air-vol-2-pt-2-exploiting-wi-fi.html
[118]: https://blog.thalium.re/posts/pivoting_to_the_secure_world/
[119]: https://googleprojectzero.blogspot.com/2023/01/exploiting-null-dereferences-in-linux.html
[120]: https://research.nccgroup.com/wp-content/uploads/2020/05/NCC_Group_Zephyr_MCUboot_Research_Report_2020-05-26_v1.0.pdf
[121]: https://trustngo.tech/2022/10/10/mcuboot-security-assessment-part-1/
[122]: https://trustngo.tech/2022/10/18/mcuboot-security-assessment-part-2/
[123]: https://eshard.com/posts/mcuboot-under-good-pressure-part-1
[124]: https://eshard.com/posts/mcuboot-under-good-pressure-part-2
[125]: https://research.nccgroup.com/2023/05/23/offensivecon-2023-exploit-engineering-attacking-the-linux-kernel/
[126]: https://blog.ret2.io/2021/06/16/intro-to-pac-arm64/
[127]: https://blog.ret2.io/2022/05/19/pwn2own-2021-parallels-desktop-exploit/
